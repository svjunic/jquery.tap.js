/*
 * Last Change: Wed Aug 13 2014 23:57:30 GMT+0900 (JST)
 * @project jquery.tap.js
 * @version 1.0.0
 * @author sv.junic@gmail.com
 * @url https://github.com/svjunic/jquery.tap.js.git
*/
!function(a,b,c){"use strict";function d(a,b){var c,d;return d=a.data(j.EVENT_NAME),"undefined"==typeof d?(c=[],c.push(b)):(c=a.data(j.EVENT_NAME).split(","),c.push(b)),d=c.join(","),a.data(j.EVENT_NAME,d),a.data(j.IS_TOUCHED,!1),a.on("touchstart touchmove touchend",f),a.on("click",g),a}function e(a){return a.removeData(j.EVENT_NAME),a.off("touchstart touchmove touchend",f),a.off("click",g),clearTimeout(a.data(j.LONG_TAP_TIMER_ID)),a}function f(a){var b=c(a.target),d=c(a.currentTarget);if("touchstart"===a.type)return d.data(j.IS_TOUCHED,!0),d.data(j.IS_TOUCH_MOVED,!1),void d.data(j.TIMESTAMP,a.timeStamp);if("touchmove"===a.type)return void d.data(j.IS_TOUCH_MOVED,!0);if("touchend"===a.type){if(d.data(j.IS_TOUCH_MOVED))return void console.log("touch moved");if(a.timeStamp-d.data(j.TIMESTAMP)>l)return void console.log("long tap");console.log("touchend listener",d.data(j.EVENT_NAME),b),h(b,d.data(j.EVENT_NAME).split(","))}}function g(a){var b=c(a.target),d=c(a.currentTarget);d.data(j.IS_TOUCHED)||(console.log("click listener",d.data(j.EVENT_NAME),b),h(b,d.data(j.EVENT_NAME).split(",")))}function h(a,b){for(var c=/^[a-zZ-Z0-9]*\.[a-zZ-Z0-9]*$/,d=0,e=b.length;e>d;d++)a.trigger(b[d]),c.test(b[d])||console.log(b[d])}function i(a){a.stopPropagation()}var j={EVENT_NAME:"eventName",IS_TOUCHED:"isToudched",IS_TOUCH_MOVED:"isToudchMoved",TIMESTAMP:"touchstartTimestamp"},k="tap",l=500,m=/^(blur|focus|change|select|selectstart|submit|reset|abort|error|load|unload|click|dblclick|keyup|keydown|keypress|mouseout|mouseover|mouseup|mousedown|mousemove|dragdrop|touchstart|touchmove|touchend)/;c.fn.listenTap=function(a){var b;if("string"!=typeof a)b=k;else{if(""===a)throw"[ jquery.tap ] Invalid eventName.";if(m.test(a))throw"[ jquery.tap ] Invalid eventName.";b=a}var e,f,g=c(this);f=g.data(j.EVENT_NAME);try{if("string"==typeof f&&(e=f.split(","),-1!==e.indexOf(b)))throw"The event has already been registered.";d(g,b)}catch(h){console.error(h)}return g.on(a,i),g},c.fn.listenTapDestroy=function(){var a=c(this);return e(a),a.off(originalEventName,i),a}}(window,document,jQuery);